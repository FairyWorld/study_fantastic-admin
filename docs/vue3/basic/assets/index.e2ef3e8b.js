
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as e}from"./index.8e17ce0a.js";import{_ as a,d as t,u as s,S as l,F as n,r,B as i,G as o,o as c,Q as u,h,b as m,x as v,e as d,s as p,g as f,c as b,i as $,H as g,N as k,M as y,U as x,p as B,k as T,y as _,A as w,J as S,n as j,q as C,f as L,t as O}from"./index.fc479745.js";const P=e=>(B("data-v-6e3c9a61"),e=e(),T(),e),H={class:"container"},I={key:0,class:"tips"},q=P((()=>m("div",{class:"tip"},[m("span",null,"Alt"),_("+"),m("span",null,"S"),_(" 唤醒搜索面板 ")],-1))),E={class:"tip"},M=_(" 切换搜索结果 "),U={class:"tip"},V=_(" 访问页面 "),A=P((()=>m("div",{class:"tip"},[m("span",null,"ESC"),_(" 退出 ")],-1))),K=["href","target","onClick","onMouseover"],N={class:"icon"},D={class:"info"},F={class:"title"},G={class:"breadcrumb"},J={class:"path"},Q=t({name:"Search"});var R=a(Object.assign(Q,{setup(a){const{proxy:t}=w(),B=s(),T=l(),P=n(),Q=r(!1),R=r(""),z=r([]),W=r(-1),X=i((()=>{let e=[];return e=z.value.filter((e=>{let a=!1;return e.title.indexOf(R.value)>=0&&(a=!0),e.path.indexOf(R.value)>=0&&(a=!0),e.breadcrumb.some((e=>e.indexOf(R.value)>=0))&&(a=!0),a})),e}));function Y(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?u(e.meta.baseBreadcrumb):[];a.push(e.meta.title);let t=u(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),Y(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=u(e.meta.baseBreadcrumb)),a.push(e.meta.title);let t="";t=S(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,z.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t,isExternalLink:S(e.path)})}}))}function Z(){X.value.length&&(W.value-=1,W.value<0&&(W.value=X.value.length-1),te(t.$refs[`search-item-${W.value}`][0].offsetTop))}function ee(){X.value.length&&(W.value+=1,W.value>X.value.length-1&&(W.value=0),te(t.$refs[`search-item-${W.value}`][0].offsetTop))}function ae(){-1!==W.value&&t.$refs[`search-item-${W.value}`][0].click()}function te(e){-1!==W.value&&(e+t.$refs[`search-item-${W.value}`][0].clientHeight>t.$refs.search.scrollTop+t.$refs.search.clientHeight||e+t.$refs[`search-item-${W.value}`][0].clientHeight<=t.$refs.search.scrollTop)&&t.$refs.search.scrollTo({top:e,behavior:"smooth"})}return o((()=>Q.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),t.$refs.search.scrollTop=0,t.$hotkeys("up",Z),t.$hotkeys("down",ee),t.$hotkeys("enter",ae),setTimeout((()=>{t.$refs.input.$el.children[0].focus()}),100)):(document.querySelector("body").classList.remove("hidden"),t.$hotkeys.unbind("up",Z),t.$hotkeys.unbind("down",ee),t.$hotkeys.unbind("enter",ae),setTimeout((()=>{R.value="",W.value=-1}),500))})),o((()=>X.value),(()=>{W.value=-1,te(0)})),c((()=>{t.$eventBus.on("global-search-toggle",(()=>{Q.value=!Q.value})),t.$hotkeys("alt+s",(e=>{B.topbar.enableNavSearch&&(e.preventDefault(),Q.value=!0)})),"filesystem"!==B.app.routeBaseOn?T.routes.map((e=>{Y(e.children)})):P.menus.map((e=>{Y(e.children)}))})),(a,t)=>{const s=j("el-input"),l=e,n=j("router-link");return C(),h(x,{to:"#app"},[m("div",{id:"search",class:g({searching:Q.value}),onClick:t[3]||(t[3]=e=>Q.value&&a.$eventBus.emit("global-search-toggle"))},[m("div",H,[m("div",{class:"search-box",onClick:t[2]||(t[2]=v((()=>{}),["stop"]))},[d(s,{ref:"input",modelValue:R.value,"onUpdate:modelValue":t[0]||(t[0]=e=>R.value=e),"prefix-icon":"el-icon-search",placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[t[1]||(t[1]=p((e=>a.$eventBus.emit("global-search-toggle")),["esc"])),p(v(Z,["prevent"]),["up"]),p(v(ee,["prevent"]),["down"]),p(v(ae,["prevent"]),["enter"])]},null,8,["modelValue","onKeydown"]),"pc"===f(B).mode?(C(),b("div",I,[q,m("div",E,[m("span",null,[d(l,{name:"search-up"})]),m("span",null,[d(l,{name:"search-down"})]),M]),m("div",U,[m("span",null,[d(l,{name:"search-enter"})]),V]),A])):$("v-if",!0)]),m("div",{ref:"search",class:g(["result",{mobile:"mobile"===f(B).mode}])},[(C(!0),b(y,null,k(f(X),((e,a)=>(C(),h(n,{key:e.path,custom:"",to:Q.value?e.path:""},{default:L((({href:t,navigate:s})=>[m("a",{ref_for:!0,ref:`search-item-${a}`,href:f(S)(e.path)?e.path:t,class:g(["item",{actived:a===W.value}]),target:f(S)(e.path)?"_blank":"_self",onClick:s,onMouseover:e=>W.value=a},[m("div",N,[e.icon?(C(),h(l,{key:0,name:e.icon},null,8,["name"])):$("v-if",!0)]),m("div",D,[m("div",F,[_(O(e.title)+" ",1),e.isExternalLink?(C(),h(l,{key:0,name:"external-link"})):$("v-if",!0)]),m("div",G,[(C(!0),b(y,null,k(e.breadcrumb,((e,a)=>(C(),b("span",{key:a},[_(O(e)+" ",1),d(l,{name:"el-icon-arrow-right"})])))),128))]),m("div",J,O(e.path),1)])],42,K)])),_:2},1032,["to"])))),128))],2)])],2)])}}}),[["__scopeId","data-v-6e3c9a61"]]);export{R as default};
