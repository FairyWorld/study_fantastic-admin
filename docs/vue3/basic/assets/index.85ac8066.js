
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as e}from"./index.2247f9f8.js";import{i as a,j as t,a as s,w as l,o as n,b as r,s as i,T as o,g as u,S as c,u as h,k as m,l as v,q as d,x as p,F as f,a2 as b,y as $,z as g,v as k,V as y,r as x,f as B,e as T,t as w}from"./vendor.9748e354.js";import{_,u as j,f as S,d as C,e as L,i as O}from"./index.d5f01412.js";const P=e=>($("data-v-6e3c9a61"),e=e(),g(),e),I={class:"container"},V={key:0,class:"tips"},q=P((()=>i("div",{class:"tip"},[i("span",null,"Alt"),k("+"),i("span",null,"S"),k(" 唤醒搜索面板 ")],-1))),E={class:"tip"},H=k(" 切换搜索结果 "),K={class:"tip"},M=k(" 访问页面 "),U=P((()=>i("div",{class:"tip"},[i("span",null,"ESC"),k(" 退出 ")],-1))),z=["href","target","onClick","onMouseover"],A={class:"icon"},D={class:"info"},F={class:"title"},N={class:"breadcrumb"},R={class:"path"},G=a({name:"Search"});var J=_(Object.assign(G,{setup(a){const{proxy:$}=y(),g=j(),_=S(),P=C(),G=t(!1),J=t(""),Q=t([]),W=t(-1),X=s((()=>{let e=[];return e=Q.value.filter((e=>{let a=!1;return e.title.indexOf(J.value)>=0&&(a=!0),e.path.indexOf(J.value)>=0&&(a=!0),e.breadcrumb.some((e=>e.indexOf(J.value)>=0))&&(a=!0),a})),e}));function Y(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?L(e.meta.baseBreadcrumb):[];a.push(e.meta.title);let t=L(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),Y(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=L(e.meta.baseBreadcrumb)),a.push(e.meta.title);let t="";t=O(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,Q.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t,isExternalLink:O(e.path)})}}))}function Z(){X.value.length&&(W.value-=1,W.value<0&&(W.value=X.value.length-1),te($.$refs[`search-item-${W.value}`][0].offsetTop))}function ee(){X.value.length&&(W.value+=1,W.value>X.value.length-1&&(W.value=0),te($.$refs[`search-item-${W.value}`][0].offsetTop))}function ae(){-1!==W.value&&$.$refs[`search-item-${W.value}`][0].click()}function te(e){-1!==W.value&&(e+$.$refs[`search-item-${W.value}`][0].clientHeight>$.$refs.search.scrollTop+$.$refs.search.clientHeight||e+$.$refs[`search-item-${W.value}`][0].clientHeight<=$.$refs.search.scrollTop)&&$.$refs.search.scrollTo({top:e,behavior:"smooth"})}return l((()=>G.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),$.$refs.search.scrollTop=0,$.$hotkeys("up",Z),$.$hotkeys("down",ee),$.$hotkeys("enter",ae),setTimeout((()=>{$.$refs.input.$el.children[0].focus()}),100)):(document.querySelector("body").classList.remove("hidden"),$.$hotkeys.unbind("up",Z),$.$hotkeys.unbind("down",ee),$.$hotkeys.unbind("enter",ae),setTimeout((()=>{J.value="",W.value=-1}),500))})),l((()=>X.value),(()=>{W.value=-1,te(0)})),n((()=>{$.$eventBus.on("global-search-toggle",(()=>{G.value=!G.value})),$.$hotkeys("alt+s",(e=>{g.topbar.enableNavSearch&&(e.preventDefault(),G.value=!0)})),"filesystem"!==g.app.routeBaseOn?_.routes.map((e=>{Y(e.children)})):P.menus.map((e=>{Y(e.children)}))})),(a,t)=>{const s=x("el-input"),l=e,n=x("router-link");return B(),r(b,{to:"#app"},[i("div",{id:"search",class:d({searching:G.value}),onClick:t[3]||(t[3]=e=>G.value&&a.$eventBus.emit("global-search-toggle"))},[i("div",I,[i("div",{class:"search-box",onClick:t[2]||(t[2]=o((()=>{}),["stop"]))},[u(s,{ref:"input",modelValue:J.value,"onUpdate:modelValue":t[0]||(t[0]=e=>J.value=e),"prefix-icon":"el-icon-search",placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[t[1]||(t[1]=c((e=>a.$eventBus.emit("global-search-toggle")),["esc"])),c(o(Z,["prevent"]),["up"]),c(o(ee,["prevent"]),["down"]),c(o(ae,["prevent"]),["enter"])]},null,8,["modelValue","onKeydown"]),"pc"===h(g).mode?(B(),m("div",V,[q,i("div",E,[i("span",null,[u(l,{name:"search-up"})]),i("span",null,[u(l,{name:"search-down"})]),H]),i("div",K,[i("span",null,[u(l,{name:"search-enter"})]),M]),U])):v("v-if",!0)]),i("div",{ref:"search",class:d(["result",{mobile:"mobile"===h(g).mode}])},[(B(!0),m(f,null,p(h(X),((e,a)=>(B(),r(n,{key:e.path,custom:"",to:G.value?e.path:""},{default:T((({href:t,navigate:s})=>[i("a",{ref_for:!0,ref:`search-item-${a}`,href:h(O)(e.path)?e.path:t,class:d(["item",{actived:a===W.value}]),target:h(O)(e.path)?"_blank":"_self",onClick:s,onMouseover:e=>W.value=a},[i("div",A,[e.icon?(B(),r(l,{key:0,name:e.icon},null,8,["name"])):v("v-if",!0)]),i("div",D,[i("div",F,[k(w(e.title)+" ",1),e.isExternalLink?(B(),r(l,{key:0,name:"external-link"})):v("v-if",!0)]),i("div",N,[(B(!0),m(f,null,p(e.breadcrumb,((e,a)=>(B(),m("span",{key:a},[k(w(e)+" ",1),u(l,{name:"el-icon-arrow-right"})])))),128))]),i("div",R,w(e.path),1)])],42,z)])),_:2},1032,["to"])))),128))],2)])],2)])}}}),[["__scopeId","data-v-6e3c9a61"]]);export{J as default};
