
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as e,u as a,j as t,h as s,k as l,i as n,c as i}from"./index.2c18650f.js";import{g as r,r as o,z as u,K as c,L as h,A as d,i as m,a4 as v,q as p,a3 as f,u as b,h as $,j as g,s as k,C as y,F as x,ab as B,p as T,k as w,y as j,O as _,a6 as C,l as L,o as O,w as S,t as I}from"./vendor.9da56f98.js";const P=e=>(T("data-v-5b9ed54d"),e=e(),w(),e),q={class:"container"},E={key:0,class:"tips"},H=P((()=>m("div",{class:"tip"},[m("span",null,"Alt"),j("+"),m("span",null,"S"),j(" 唤醒搜索面板 ")],-1))),K={class:"tip"},V=j(" 切换搜索结果 "),A={class:"tip"},M=j(" 访问页面 "),U=P((()=>m("div",{class:"tip"},[m("span",null,"ESC"),j(" 退出 ")],-1))),z=["href","target","onClick","onMouseover"],D={class:"icon"},F={class:"info"},N={class:"title"},R={class:"breadcrumb"},G={class:"path"},J=r({name:"Search"});var Q=e(Object.assign(J,{setup(e){const{proxy:r}=_(),T=a(),w=t(),P=s(),J=C("generateI18nTitle"),Q=o(!1),W=o(""),X=o([]),Y=o(-1),Z=u((()=>{let e=[];return e=X.value.filter((e=>{let a=!1;return J(e.i18n,e.title).indexOf(W.value)>=0&&(a=!0),e.path.indexOf(W.value)>=0&&(a=!0),e.breadcrumb.some((e=>J(e.i18n,e.title).indexOf(W.value)>=0))&&(a=!0),a})),e}));function ee(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?l(e.meta.baseBreadcrumb):[];a.push({title:e.meta.title,i18n:e.meta.i18n});let t=l(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),ee(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=l(e.meta.baseBreadcrumb)),a.push({title:e.meta.title,i18n:e.meta.i18n});let t="";t=n(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,X.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t,isExternalLink:n(e.path)})}}))}function ae(){Z.value.length&&(Y.value-=1,Y.value<0&&(Y.value=Z.value.length-1),le(r.$refs[`search-item-${Y.value}`][0].offsetTop))}function te(){Z.value.length&&(Y.value+=1,Y.value>Z.value.length-1&&(Y.value=0),le(r.$refs[`search-item-${Y.value}`][0].offsetTop))}function se(){-1!==Y.value&&r.$refs[`search-item-${Y.value}`][0].click()}function le(e){-1!==Y.value&&(e+r.$refs[`search-item-${Y.value}`][0].clientHeight>r.$refs.search.scrollTop+r.$refs.search.clientHeight||e+r.$refs[`search-item-${Y.value}`][0].clientHeight<=r.$refs.search.scrollTop)&&r.$refs.search.scrollTo({top:e,behavior:"smooth"})}return c((()=>Q.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),r.$refs.search.scrollTop=0,r.$hotkeys("up",ae),r.$hotkeys("down",te),r.$hotkeys("enter",se),setTimeout((()=>{r.$refs.input.$el.children[0].focus()}),100)):(document.querySelector("body").classList.remove("hidden"),r.$hotkeys.unbind("up",ae),r.$hotkeys.unbind("down",te),r.$hotkeys.unbind("enter",se),setTimeout((()=>{W.value="",Y.value=-1}),500))})),c((()=>Z.value),(()=>{Y.value=-1,le(0)})),h((()=>{r.$eventBus.on("global-search-toggle",(()=>{Q.value=!Q.value})),r.$hotkeys("alt+s",(e=>{T.toolbar.enableNavSearch&&(e.preventDefault(),Q.value=!0)})),"filesystem"!==T.app.routeBaseOn?w.routes.map((e=>{ee(e.children)})):P.menus.map((e=>{ee(e.children)}))})),(e,a)=>{const t=L("el-input"),s=i,l=L("router-link");return O(),d(B,{to:"#app"},[m("div",{id:"search",class:k({searching:Q.value}),onClick:a[3]||(a[3]=a=>Q.value&&e.$eventBus.emit("global-search-toggle"))},[m("div",q,[m("div",{class:"search-box",onClick:a[2]||(a[2]=v((()=>{}),["stop"]))},[p(t,{ref:"input",modelValue:W.value,"onUpdate:modelValue":a[0]||(a[0]=e=>W.value=e),"prefix-icon":"el-icon-search",placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[a[1]||(a[1]=f((a=>e.$eventBus.emit("global-search-toggle")),["esc"])),f(v(ae,["prevent"]),["up"]),f(v(te,["prevent"]),["down"]),f(v(se,["prevent"]),["enter"])]},null,8,["modelValue","onKeydown"]),"pc"===b(T).mode?(O(),$("div",E,[H,m("div",K,[m("span",null,[p(s,{name:"search-up"})]),m("span",null,[p(s,{name:"search-down"})]),V]),m("div",A,[m("span",null,[p(s,{name:"search-enter"})]),M]),U])):g("v-if",!0)]),m("div",{ref:"search",class:k(["result",{mobile:"mobile"===b(T).mode}])},[(O(!0),$(x,null,y(b(Z),((e,a)=>(O(),d(l,{key:e.path,custom:"",to:Q.value?e.path:""},{default:S((({href:t,navigate:l})=>[m("a",{ref_for:!0,ref:`search-item-${a}`,href:b(n)(e.path)?e.path:t,class:k(["item",{actived:a===Y.value}]),target:b(n)(e.path)?"_blank":"_self",onClick:l,onMouseover:e=>Y.value=a},[m("div",D,[e.icon?(O(),d(s,{key:0,name:e.icon},null,8,["name"])):g("v-if",!0)]),m("div",F,[m("div",N,[j(I(b(J)(e.i18n,e.title))+" ",1),e.isExternalLink?(O(),d(s,{key:0,name:"external-link"})):g("v-if",!0)]),m("div",R,[(O(!0),$(x,null,y(e.breadcrumb,((e,a)=>(O(),$("span",{key:a},[j(I(b(J)(e.i18n,e.title))+" ",1),p(s,{name:"el-icon-arrow-right"})])))),128))]),m("div",G,I(e.path),1)])],42,z)])),_:2},1032,["to"])))),128))],2)])],2)])}}}),[["__scopeId","data-v-5b9ed54d"]]);export{Q as default};
